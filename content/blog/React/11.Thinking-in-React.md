---
title: 11.Thinking in React
date: 2019-06-04 17:06:82
category: React
---
(React 공식문서의 main concepts 번역 글입니다.)  
  
**함께보면 이해가 쏙쏙**  
https://youtu.be/T6Wj2pbkorA  
  
React는 Javascript로  
규모가 있는 Web app을 만드는 빠른 방법이다.  
  
이번 글에서는 React를 활용해서 제품 검색 app을 구현할 것이다.  
그 과정을 통해 React 활용 방법에 대해 더 구체적으로 학습할 수 있다.

##Mockup design으로 시작하자
JSON API와 UI모형 디자인을 가지고 있다고 가정하자.  
UI모형 디자인은 아래 사진과 같은 모양일 것이다.  

![](./images/mock_data.png)

JSON API가 return 하는 data의 형태는 아래와 같다.

```js
[
  {category: "Sporting Goods", price: "$49.99", stocked: true, name: "Football"},
  {category: "Sporting Goods", price: "$9.99", stocked: true, name: "Baseball"},
  {category: "Sporting Goods", price: "$29.99", stocked: false, name: "Basketball"},
  {category: "Electronics", price: "$99.99", stocked: true, name: "iPod Touch"},
  {category: "Electronics", price: "$399.99", stocked: false, name: "iPhone 5"},
  {category: "Electronics", price: "$199.99", stocked: true, name: "Nexus 7"}
];
```

##STEP1. UI 요소를 component 단위로 쪼개자
첫번째, component로 구성할 부분에 박스를 그리자.  
그리고 박스로 구분한 각 component들에게 이름을 붙이자.  
  
만약 디자이너와 일한다면 이미 위 작업을 했을 수 있다.  
디자이너와 얘기해서 포토샵의 layer 이름을 물어보자.  
layer 이름을 component 이름으로 사용할 수 있다.  

###component 만들기 기준?  
그러나 어떠한 기준으로 component를 만들어야 할지 모른다면?  
새로운 function 혹은 object를 만드는 기준을 적용하자.  
그 기준 중 하나는 single responsibility principle  
즉, component는 한가지 로직만 수행해야 한다는 것이다.  
(input 1개 output 1개)  
  
만약 component가 복잡해져서 두가지 이상의 로직을 수행한다면  
해당 component는 더 작은 component로 쪼개야 한다.  
  
JSON data model을 토대로 UI를 구성하기 때문에  
component를 만드는 기준은  
UI보다 data model이 더 적합하다.  
하나의 data model을 완벽히 보여줄 수 있도록  
component를 만들자  

![](./images/component_1.png)

우리가 만드는 제품 검색 App은 5개 component로 구성되어 있다.  
5개 component들 각각의 역할을 아래에 설명했다.  
(component가 보여주는 data는 _이탤릭체_ 로 표시했다.)

1. **FilterableProductTable(오렌지색):** 전체를 포함하는 component
2. **SearchBar(파란색):** 모든 input tag의 _value_ 값 받는다
3. **ProductTable(초록색):** _data모음_ 을 input tag _value_ 값을 기준으로 filtering 하고 보여준다
4. **ProductCategoryRow(청록색):** 각 _category_ 의 이름을 보여준다
5. **ProductRow(빨간색):** 각 product의 _data_ 를 보여준다.

3번 `ProductTable` component를 보면  
표의 header(Name, Price 글자)만 포함하는 것이 아니라  
표 전체를 포함하고 있음을 확인할 수 있다.  
ProductTable에서 header의 역할이 보여주는 것 뿐이어서  
(render 로직 1가지만 수행함 single responsibility)  
header를 따로 분리하여 component를 만들지 않았다.  
  
하지만 header에 Name, Price 글자 이외에  
정렬을 위한 요소를 추가하는 경우, 즉 기능이 추가되는 경우  
header를 따로 분리하여 component로 만들 수 있다.  

###component의 계층 구조
제품 검색 App에 대한 component 만들기가 끝난 후  
component의 계층 구조를 만들자.  
박스로 구분한 component들을 보면서  
부모 자식 관계를 설정한다(자식을 포함한 박스가 부모가 됨)  
위 제품 검색 App의 component 계층 구조는 다음과 같다.  
  
- FilterableProductTable
  - SearchBar
  - ProductTable
    - ProductCategoryRow
    - ProductRow

##STEP2. 상호작용이 없는(static한) React page 만들기
component 계층 구조가 완성된 후, 비어있는 App을 채울 차례다.  
가장 쉬운 방법은 상호작용이 없는 React page를 만드는 것이다.  
물론 data model을 가져와서 보여주는 UI로 구성된 page이다.  
  
사용자와 상호작용이 없는 React page를 만드는 과정과  
그 React page가 상호작용할 수 있도록 만드는 과정을 분리하자.  
왜냐하면 상호작용이 없는 React page를 만드는 과정은  
생각없이 타자만 치면 되는 노가다인 반면에,  
상호작용이 있는 React page를 만드는 과정은  
타자치기보다는 생각을 정말 많이 해야하기 때문이다.  
  
###상호작용이 없는 App 구현 시 component의 특징
data model을 효율적으로 보여주는 App을 만들기 위해서는  
다른 component를 재사용하고, data를 props로 전달하는  
component로 App을 구성해야 한다.  
  
props는 부모에서 자식으로만 전달될 수 있다.  
따라서 props는 _바뀌는 data를 표현할 수 없다_.  
바뀌는 data를 표현하기 위해서는 **state를 사용**해야 하지만  
상호작용이 없는 React page에서는 data가 바뀌지 않으므로  
현재 단계에서는 아직 state를 사용하지 않아도 된다.  

###구체적인 App 구현 방법과 동작 원리
App을 만들때, 하위 component(ProductRow)부터 만들 수도 있고  
상위 component(FilterableProductTable)부터 만들 수도 있다.  
계층구조가 **복잡한 App**은 _하위 component부터_ 구현하는 편이고  
계층구조가 **간단한 App**은 _상위 component부터_ 구현하는 편이다.  
현재 App은 간단한 App에 속하므로 상위 component부터 구현하자.  
  
또한, 현재 App은 상호작용이 없는 App이기 때문에  
이 App을 구성하는 모든 component들은 _render() method 만_ 있다.  
이 component들의 동작 원리는 아래와 같다.  
계층 구조에 꼭대기에 있는 component(`FilterableProductTable`)는  
data model을 **props**로 전달 받는다.  
만약 이 data model에 속한 data, 즉 _**props**의 값을 바꾼 후_  
다시 `ReactDOM.render()`를 호출한다면  
UI는 바뀐 data 값을 반영하여 업데이트 될 것이다.  
  
> React에서 data는 위에서 아래로만 전달된다.(one-way data flow)
이러한 특징때문에 React는 모듈화하기 쉽고 속도가 빠르다.  

###Props vs State
React에서는 2가지 data model의 형태(props와 state)가 있다.  
props와 state의 **차이**를 이해하는 것은 중요하다.  
앞의 state편 블로깅을 참고하여 반드시 둘의 차이를 이해하자.  

##STEP3. state에 할당할 수 있는 핵심 data 찾기
상호작용이 가능한 React page를 만드려면  
data model의 data 값을 바꿀 수 있어야 한다.  
이는 React에서 **state**를 활용하면 가능하다.  
  
제품 검색 App을 만들 때 state를 바르게 활용하기 위해서  
가장 먼저, 바꿔야하는 **핵심 data**을 파악하자.
핵심 data란 다른 data(props, state)로부터  
계산을 통해 얻을 수 없는 data를 말한다.  
핵심 data를 파악하지 못하면 state를 _중복_ 할당하게 된다.  
이때 기준이 되는 _DRY_ 를 기억하자(_Don't Repeat Yourself_)  
핵심 data를 파악했다면 이를 state에 할당하자.  
  
예를 들어 TODO list 앱을 만들거라면  
TODO item을 담은 array를 state에 할당해야 한다.  
그럼 TODO item의 개수를 state로 중복 할당하지 않을 수 있다.  
array.length 값이 TODO item의 개수이기 때문이다.  
  
그럼 제품 검색 App에서는 어떠한 data를 state에 할당해야 할까
제품 검색 App에서 모든 data를 나열하면 아래와 같다.

- product 목록
- 검색하기 위해 사용자가 입력한 text
- checkbox의 value
- filtering 된 product 목록

아래 3가지 질문에 대답하며  
어떠한 data를 state에 할당할 수 있을지 알아보자.

1. 부모로부터 props로 전달받은 data인가?  
2. 시간이 지나도 값이 바뀌지 않는 data인가?
3. 다른 data(props, state)로부터 계산을 통해 얻을 수 있는 data인가?

3가지 질문에 전부 No라고 대답할 수 있는 data가  
state에 할당할 수 있는 핵심 data이다.  
  
제품 검색 App의 data목록 중 첫번째 `product 목록`은  
props로 전달받은 data이므로 state에 할당할 수 없다.  
두번째 `사용자가 입력한 text`와 세번째 `checkbox의 value`는  
2가지 다 state에 할당할 수 있다.  
시간이 지나면 값이 바뀌며, 계산을 통해 얻을 수 없기 때문이다.  
마지막 `filtering된 product 목록`은 state에 할당할 수 없다.  
`사용자가 입력한 text`와 `checkbox의 value`를 기준으로
`product 목록`으로부터 계산을 통해 얻을 수 있기 때문이다.  
  
따라서 state로 활용할 수 있는 data는 아래 2가지이다.  

- 검색하기 위해 사용자가 입력한 text
- checkbox의 value

##STEP4. state를 저장할 component 결정하기